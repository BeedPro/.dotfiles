#!/bin/bash

# Configuration
SRC_DIR="$HOME/.local/src/AdnanHodzic"
REPO_DIR="$SRC_DIR/auto-cpufreq"
REPO_URL="https://github.com/AdnanHodzic/auto-cpufreq.git"

echo "Step 1: Installing dependencies..."
sudo apt update
sudo apt install -y \
    ninja-build \
    gettext \
    cmake \
    curl \
    build-essential \
    lua5.3 \
    liblua5.3-dev \
    git

echo "Step 2: Cloning repository..."
mkdir -p "$SRC_DIR"
if [ -d "$REPO_DIR" ]; then
    rm -rf "$REPO_DIR"
fi

git clone --depth 1 "$REPO_URL" "$REPO_DIR"
cd "$REPO_DIR" || exit 1

echo "Step 3: Building and installing auto-cpufreq..."
sudo ./auto-cpufreq-installer

echo "Step 4: Cleaning up source files..."
rm -rf "$REPO_DIR"

echo "------------------------------------------------"
echo "Installation of auto-cpufreq is complete!"
echo "Check status with: auto-cpufreq --stats"
