# To rename window do C-Space ,
# To rename session do C-Space $

set-option -sa terminal-overrides ",xterm*:Tc"
set -g default-terminal "tmux-256color"
set -g terminal-features 'alacritty:RGB,foot:RGB,st:RGB,kitty:RGB,wezterm:RGB,xterm*:RGB'
set -g allow-passthrough on

bind-key x kill-pane # skip "kill-pane 1? (y/n)" prompt
set -g detach-on-destroy off  # don't exit from tmux when closing a session

# Rebind Prefix to CTRL-Space
unbind C-b
set -g prefix C-Space
bind C-Space send-prefix

# Start windows and panes at 1, not 0
set -g base-index 1
set -g pane-base-index 1
set-window-option -g pane-base-index 1
set-option -g renumber-windows on

# Enable mouse support
set -g mouse on

# Increase history limit, as we want an "almost" unlimited buffer.
# May be set to something even higher, like 250k
set-option -g history-limit 100000

# Smart terminal title (session | window | command | path)
set -g set-titles on
set -g automatic-rename off
set -g set-titles-string "tmux - #S"

# Open new windows and panes in the current working directory of the active
# pane.
bind c new-window -c "#{pane_current_path}"
bind '"' split-window -c "#{pane_current_path}"
bind % split-window -h -c "#{pane_current_path}"
# bind g display-popup -d "#{pane_current_path}" -w 80% -h 80% -E "lazygit"
bind-key -n M-b set -g status

# Disable waiting time when pressing escape, for smoother Neovim usage. Disable
# if differentiation between function and meta keycombination is needed.
set-option -s escape-time 0

# Vim style pane selection
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

bind-key -T copy-mode-vi 'C-Space' select-pane -t:.+

# Resizing panes with arrow keys
bind-key -n S-Up resize-pane -U 5
bind-key -n S-Down resize-pane -D 5
bind-key -n S-Left resize-pane -L 5
bind-key -n S-Right resize-pane -R 5

# Alt n,p keys to switch windows
bind -n M-h previous-window
bind -n M-l next-window

# set vi-mode
set-window-option -g mode-keys vi

# Copying using vim keybindings
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi C-v send-keys -X rectangle-toggle
bind-key -T copy-mode-vi y send-keys -X copy-selection-and-cancel

# Sesh
bind-key "o" display-popup -d "#{pane_current_path}" -w 66% -h 66% -E "~/.local/scripts/sesh-launcher"
bind-key "n" display-popup -d "#{pane_current_path}" -w 66% -h 66% -E '~/.local/scripts/sesh-create'

bind-key -n M-t switch-client -l


##
# Styling catppuccin mocha
##

RED="#f38ba8"
GREEN="#a6e3a1"
YELLOW="#f9e2af"
BLUE="#89b4fa"
MAUVE="#cba6f7"
LAVENDER="#b4befe"
SUBTEXT="#a6adc8"
BG="#1e1e2e"
SUR="#6c7086"
FG="#cdd6f4"

# Put the the status line on the top
set-option -g status-position top
set-option -g status off

set -g pane-border-lines simple
set -g pane-border-style fg=${SUR}
set -g pane-active-border-style fg=${BLUE}

# Basic colors of the Statusbar
set-option -g status-style bg=${BG},fg=${FG}

# Show the window list centered between the left and the right section
set-option -g status-justify left

# Style and set contents on the left section
set-option -g status-left ""

# Style and set contents on the right section
set-option -g status-right "#[fg=${MAUVE}]#S"

# Set max length of left and right section
set-option -g status-left-length 100
set-option -g status-right-length 100

# Style and set content for the inactive windows
set-option -g window-status-format "#[fg=${SUBTEXT}]#I:#W- "

# Style and set content for the active windows
set-option -g window-status-current-format "#[fg=${GREEN}]#I:#W* "

# Remove the separator between window list items, as we already have spacing
# "around" inactive items
set-option -g window-status-separator ""
