# To rename window do C-Space ,
# To rename session do C-Space $

set-option -sa terminal-overrides ",xterm*:Tc"
set -g default-terminal "tmux-256color"
set -g terminal-features 'alacritty:RGB,foot:RGB,st:RGB,kitty:RGB,wezterm:RGB,xterm*:RGB'
set -g allow-passthrough on


bind-key x kill-pane # skip "kill-pane 1? (y/n)" prompt
set -g detach-on-destroy off  # don't exit from tmux when closing a session

# Rebind Prefix to CTRL-Space
unbind C-b
set -g prefix C-Space
bind C-Space send-prefix

# Start windows and panes at 1, not 0
set -g base-index 1
set -g pane-base-index 1
set-window-option -g pane-base-index 1
set-option -g renumber-windows on

# Enable mouse support
set -g mouse on

# Increase history limit, as we want an "almost" unlimited buffer.
# May be set to something even higher, like 250k
set-option -g history-limit 100000

# Smart terminal title (session | window | command | path)
set -g set-titles on
set -g automatic-rename off
set -g set-titles-string "tmux - #S"

# Open new windows and panes in the current working directory of the active
# pane.
bind c new-window -c "#{pane_current_path}"
bind '"' split-window -c "#{pane_current_path}"
bind % split-window -h -c "#{pane_current_path}"
bind-key -n M-b set -g status

# Disable waiting time when pressing escape, for smoother Neovim usage. Disable
# if differentiation between function and meta keycombination is needed.
set-option -s escape-time 0

# Vim style pane selection
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

bind-key -T copy-mode-vi 'C-Space' select-pane -t:.+

# Resizing panes with arrow keys
bind-key -n S-Up resize-pane -U 5
bind-key -n S-Down resize-pane -D 5
bind-key -n S-Left resize-pane -L 5
bind-key -n S-Right resize-pane -R 5

# Alt n,p keys to switch windows
bind -n M-h previous-window
bind -n M-l next-window

# set vi-mode
set-window-option -g mode-keys vi

# Copying using vim keybindings
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi C-v send-keys -X rectangle-toggle
bind-key -T copy-mode-vi y send-keys -X copy-selection-and-cancel

# Sesh
bind-key "o" display-popup -d "#{pane_current_path}" -w 66% -h 66% -E "~/.local/scripts/sesh-launcher"
bind-key "n" display-popup -d "#{pane_current_path}" -w 66% -h 66% -E '~/.local/scripts/sesh-create'

bind-key -n M-t switch-client -l

set -g status on
set -g status-position top

# Pane borders
set -g pane-border-style fg=colour8
set -g pane-active-border-style fg=colour8

# Status bar (NO background)
set -g status-style bg=default,fg=colour7
set -g status-justify left

# Status sections
set -g status-left ""
set -g status-right "#[fg=colour5]#S"
set -g status-left-length 100
set -g status-right-length 100

# Window list
set -g window-status-format "#[fg=colour8]#I:#W "
set -g window-status-current-format "#[fg=colour2]#I:#W* "
set -g window-status-separator ""
